library("ape")
align <- read.csv("../data/all_data_bcd_2019_10_01_after_QC.csv")
setwd("C:/Users/zliu1/montium_5_TFBS_evolution/R")
#library("Biostrings")
library("ape")
#library("Biostrings")
library("ape")
align <- read.csv("../data/all_data_bcd_2019_10_01_after_QC.csv")
align_ex <- read.fasta("../data/alignments/align_outlier_rm_with_length_VT0809.fa")
library("Biostrings")
align_ex <- read.fasta("../data/alignments/align_outlier_rm_with_length_VT0809.fa")
library("seqinr")
align_ex <- read.fasta("../data/alignments/align_outlier_rm_with_length_VT0809.fa")
tree <- read.tree("../data/tree/montium_phylogram_newick.tre")
names <- tree$tip.label
names(align_ex) <- names[1:24]
align_ex
View(align_ex)
fname <- tempfile(pattern = "ortho3", tmpdir = tempdir(), fileext = "fasta")
write.fasta(align_ex, names(align_ex), fname, open = "w", nbchar = 60, as.string = FALSE)
write.fasta(align_ex, names(align_ex), fname, open = "w")
fname <- tempfile(pattern = "ortho3", tmpdir = tempdir(), fileext = "fa")
write.fasta(align_ex, names(align_ex), fname, open = "w")
write.fasta(align_ex, names(align_ex), file.out="temp.fa", open = "w")
neutral <- read.module(modelfile.mod, ignore.validity = F)
install.packages("ProTrackR")
library("ProTrackR")
neutral <- read.module(modelfile.mod, ignore.validity = F)
neutral <- read.module("modelfile.mod", ignore.validity = F)
align <- read.csv("../data/all_data_bcd_2019_10_01_after_QC.csv")
align <- read.csv("../data/all_data_bcd_2019_10_01_after_QC.csv")
species_key <- read.csv("../data/montium_species_laneID.csv")
species <- species_key$species
species <- species_key$species
lane <- species_key$lane_ID
## replace all the lane IDs with species names
for(j in seq_along(lane)){
dataset$species <- gsub(lane[j], species[j], dataset$species)
}
align$species <- gsub(lane[j], species[j], dataset$species)
align$species <- gsub(lane[j], species[j], align$species)
## replace all the lane IDs with species names
for(j in seq_along(lane)){
align$species <- gsub(lane[j], species[j], align$species)
}
View(align)
View(align)
names(align)
library("Biostrings")
library("Biostrings")
library("ape")
library("seqinr")
library("ProTrackR")
names(align$species)
species(align)
## replace all the lane IDs with species names
for(j in seq_along(lane)){
align$names <- gsub(lane[j], species[j], align$names)
}
align <- read.csv("../data/all_data_bcd_2019_10_01_after_QC.csv")
## replace all the lane IDs with species names
for(j in seq_along(lane)){
align$names <- gsub(lane[j], species[j], align$names)
}
## replace all the lane IDs with species names
for(j in seq_along(lane)){
align$names <- gsub(lane[j], species[j], align$species)
}
## replace all the lane IDs with species names
for(j in seq_along(lane)){
align$species <- gsub(lane[j], species[j], align$species)
}
algin$names <- align$species
align$names <- align$species
names(align)
align_ex <- read.fasta("../data/alignments/align_outlier_rm_with_length_VT0809.fa")
names(align_ex)
for(j in seq_along(lane)){
align_ex$species <- gsub(lane[j], species[j], align_ex$species)
}
names(align_ex)
for(j in seq_along(lane)){
align_ex$names <- gsub(lane[j], species[j], align_ex$names)
}
names(align_ex)
temp <- align[align$region = "VT0809" ]
temp <- align[align$region == "VT0809" ]
temp <- align[which(align$region == "VT0809") ]
temp <- align[align$region == "VT0809", ]
temp
names(align_ex) <- temp$species
fname <- tempfile(pattern = "ortho3", tmpdir = tempdir(), fileext = "fa")
write.fasta(align_ex, names(align_ex), file.out="temp.fa", open = "w")
species_key <- read.csv("../data/montium_species_laneID2.csv")
species <- species_key$species
lane <- species_key$lane_ID
## replace all the lane IDs with species names
for(j in seq_along(lane)){
align$species <- gsub(lane[j], species[j], align$species)
}
fname <- tempfile(pattern = "ortho3", tmpdir = tempdir(), fileext = "fa")
write.fasta(align_ex, names(align_ex), file.out="temp.fa", open = "w")
align <- read.csv("../data/all_data_bcd_2019_10_01_after_QC.csv")
align <- read.csv("../data/all_data_bcd_2019_10_01_after_QC.csv")
align_ex <- read.fasta("../data/alignments/align_outlier_rm_with_length_VT0809.fa")
tree <- read.tree("../data/tree/montium_phylogram_newick.tre")
tree <- read.tree("../data/tree/montium_phylogram_newick.tre")
names <- tree$tip.label
names(align_ex) <- names[1:24]
fname <- tempfile(pattern = "ortho3", tmpdir = tempdir(), fileext = "fa")
write.fasta(align_ex, names(align_ex), file.out="temp.fa", open = "w")
neutral <- read.module("modelfile.mod", ignore.validity = F)
neutral <- read.module("modelfile.mod")
library("Biostrings")
library("Biostrings")
library("ape")
library("seqinr")
library("ProTrackR")
align <- read.csv("../data/all_data_bcd_2019_10_01_after_QC.csv")
species_key <- read.csv("../data/montium_species_laneID2.csv")
species <- species_key$species
lane <- species_key$lane_ID
## replace all the lane IDs with species names
for(j in seq_along(lane)){
align$species <- gsub(lane[j], species[j], align$species)
}
## replace all the lane IDs with species names
for(j in seq_along(lane)){
align$species <- gsub(lane[j], species[j], align$species)
}
tree <- read.tree("../data/tree/cleanedTree.tre")
align_ex <- read.fasta("../data/alignments/align_outlier_rm_with_length_VT0809.fa")
temp <- align[align$region == "VT0809", ]
#get alignment file with correct names
names(align_ex) <- temp$species
align_ex[align_ex != "MEMB008C"]
align_ex <- align_ex[align_ex != "MEMB008C"]
align_ex[align_ex = "MEMB008C"]
names(align_ex)
align_ex <- align_ex[names(align_ex) %in% "MEMB008C" == FALSE]
align_ex <- align_ex[names(align_ex) %in% c("MEMB008C", "MEMB004A") == FALSE]
fname <- tempfile(pattern = "ortho3", tmpdir = tempdir(), fileext = "fa")
write.fasta(align_ex, names(align_ex), file.out="temp.fa", open = "w")
neutral <- read.module("modelfile.mod", ignore.validity = F)
